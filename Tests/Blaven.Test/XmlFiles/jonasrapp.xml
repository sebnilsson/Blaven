<feed gd:etag="W/&quot;A08ASH89fip7ImA9WhJWFEk.&quot;" xmlns="http://www.w3.org/2005/Atom" xmlns:openSearch="http://a9.com/-/spec/opensearch/1.1/" xmlns:blogger="http://schemas.google.com/blogger/2008" xmlns:georss="http://www.georss.org/georss" xmlns:gd="http://schemas.google.com/g/2005" xmlns:thr="http://purl.org/syndication/thread/1.0">
  <author>
    <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="http://4.bp.blogspot.com/-zdyc2dXCjkI/T2c1Laz1k_I/AAAAAAAAALQ/PRBNUtVTqu8/s1600/seni.jpg" />
    <name>Seb Nilsson</name>
    <email>noreply@blogger.com</email>
    <uri>http://www.blogger.com/profile/14768605583956023472</uri>
  </author>
  <category term="Ribbon" />
  <category term="Customization" />
  <category term="Metadata" />
  <category term="Plugins" />
  <category term="N:N-relations" />
  <category term="Forms" />
  <category term="Javascript" />
  <category term="Rollup 8" />
  <category term="WebResources" />
  <generator>Blogger</generator>
  <id>tag:blogger.com,1999:blog-3534158126191039150</id>
  <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default?max-results=2147483647" rel="http://schemas.google.com/g/2005#feed" type="application/atom+xml" />
  <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default?max-results=2147483647" rel="self" type="application/atom+xml" />
  <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default" rel="http://schemas.google.com/g/2005#post" type="application/atom+xml" />
  <link href="http://jonasrapp.cinteros.se/" rel="alternate" type="text/html" />
  <link href="http://pubsubhubbub.appspot.com/" rel="hub" />
  <title type="text">Jonas Rapp's CRM Trenches</title>
  <updated>2012-08-20T10:04:09+02:00</updated>
  <entry gd:etag="W/&quot;D0IBQHg4cCp7ImA9WhJWFEk.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-08-20T08:52:31.638+02:00</app:edited>
    <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://lh5.ggpht.com/-iqNUT6u6nvQ/UC4ux8tzuQI/AAAAAAAAAtI/_91LPjV_kQ4/s72-c/FileNewActivity_thumb.png?imgmax=800" height="72" width="72" />
    <thr:total>0</thr:total>
    <title type="text">Automatically Set Regarding on New Activities</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-3351494039612406157</id>
    <link href="http://jonasrapp.cinteros.se/feeds/3351494039612406157/comments/default" rel="replies" type="application/atom+xml" title="Post Comments" />
    <link href="http://jonasrapp.cinteros.se/2012/08/setregarding.html#comment-form" rel="replies" type="text/html" title="0 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/3351494039612406157" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/3351494039612406157" rel="self" type="application/atom+xml" />
    <link href="http://jonasrapp.cinteros.se/2012/08/setregarding.html" rel="alternate" type="text/html" title="Automatically Set Regarding on New Activities" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <category term="Customization" scheme="http://www.blogger.com/atom/ns#" />
    <category term="Javascript" scheme="http://www.blogger.com/atom/ns#" />
    <category term="Metadata" scheme="http://www.blogger.com/atom/ns#" />
    <content type="html">
      &lt;h2&gt;Summary&lt;/h2&gt; &lt;p&gt;Missing functionality in the MS CRM 2011 OOB functionality:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;Activities created from menu File – New Activity on entity forms do not get the Regarding field populated.  &lt;li&gt;When creating new activities from the associated view on the entity form, the Regarding field is mapped properly.&lt;/li&gt;&lt;/ul&gt; &lt;p&gt;&lt;a href="http://lh5.ggpht.com/-16CLw5Isq60/UC4uxHMm4MI/AAAAAAAAAtA/HxRtB97LyI0/s1600-h/FileNewActivity%25255B2%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="FileNewActivity" border="0" alt="FileNewActivity" src="http://lh5.ggpht.com/-iqNUT6u6nvQ/UC4ux8tzuQI/AAAAAAAAAtI/_91LPjV_kQ4/FileNewActivity_thumb.png?imgmax=800" width="221" height="244"&gt;&lt;/a&gt;In this post, I will demonstrate a&lt;strong&gt; javascript example of a generic way to populate the Regarding field on activities&lt;/strong&gt;, where the OOB CRM functionality fails to do this.&lt;a href="http://lh3.ggpht.com/-BMYZ-GcuEFg/UC4uyst2ycI/AAAAAAAAAtQ/l9hO2YQOSCU/s1600-h/TaskWORegarding%25255B2%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="TaskWORegarding" border="0" alt="TaskWORegarding" src="http://lh3.ggpht.com/-jgK-m0lwhSs/UC4uzV-LUMI/AAAAAAAAAtY/-T-MFXj-bMI/TaskWORegarding_thumb.png?imgmax=800" width="244" height="129"&gt;&lt;/a&gt;&lt;/p&gt; &lt;h2&gt;Objective&lt;/h2&gt; &lt;p&gt;Whenever possible, the activity form shall to try to find which record that should be set as &lt;em&gt;regarding&lt;/em&gt;.&lt;/p&gt; &lt;p&gt;While doing this, also provide an opportunity to specify which entities that shall be allowed as regarding for each type of activity entity.&lt;/p&gt; &lt;h2&gt;Method&lt;/h2&gt; &lt;ol&gt; &lt;li&gt;As the activity form is not opened with any parameters indicating "where it came from", I investigate &lt;code&gt;window.parent.opener&lt;/code&gt; to find information of its origin.  &lt;li&gt;Metadata requests are used to find additional information of the source, to be able to map between &lt;em&gt;ObjectTypeCode&lt;/em&gt; and &lt;em&gt;LogicalName&lt;/em&gt;, as well as to dynamically find which attribute on the source that is the primary attribute (i.e. the "name" attribute").  &lt;li&gt;I perform a &lt;em&gt;REST&lt;/em&gt; request to find the name of the source record, instead of e.g. trying to walk through the source form's DOM to find information about it.&lt;/li&gt;&lt;/ol&gt; &lt;h2&gt;Code samples&lt;/h2&gt;  &lt;a name='more'&gt;&lt;/a&gt;  &lt;p&gt;Function to verify and populate the Regarding field:&lt;/p&gt;&lt;pre class="brush: js"&gt;Cinteros.Xrm.Activity = {
      _verifyRegarding: function (regardingEntities) {
      try {
      // First check if we have a valid mapped regardingobject
      var regardingObjectId = Xrm.Page.getAttribute("regardingobjectid").getValue();
      if (regardingObjectId &amp;&amp; regardingObjectId[0].entityType) {
      // We have a regarding object through mapping, verify it is from an allowed entity
      if (!regardingEntities || !regardingEntities.length) {
      return true;
      }
      for (var i = 0; i &lt; regardingEntities.length; i++) {
      if (regardingObjectId[0].entityType === regardingEntities[i]) {
      return true;
      }
      }
      return false;
      }
      // No regarding object was set - now examine opener to see where we came from
      if (window &amp;&amp; window.parent &amp;&amp; window.parent.opener &amp;&amp; window.parent.opener.location &amp;&amp; window.parent.opener.location.href) {
      var href = window.parent.opener.location.href;
      // Extract parent etc from its href
      var parentEtc = Cinteros.Xrm.SDK.getParameter(href, "etc") || Cinteros.Xrm.SDK.getParameter(href, "oType");
      // Get metadata for parent entitytype
      var regardingEntityMeta;
      var entityMetadataCollection;
      if (!regardingEntities || !regardingEntities.length) {
      // No allowed entities specified, load metadata for all entities
      entityMetadataCollection = Cinteros.Xrm.SDK.RetrieveAllEntities();
      }
      else {
      // Load metadata only for allowed entities
      entityMetadataCollection = [];
      for (var i = 0; i &lt; regardingEntities.length; i++) {
      entityMetadataCollection.push(Cinteros.Xrm.SDK.RetrieveEntity(regardingEntities[i]));
      }
      }
      // Get the metadata for correct parent entity, based on etc/otc
      for (var i = 0; i &lt; entityMetadataCollection.length; i++) {
      if (entityMetadataCollection[i].ObjectTypeCode == parentEtc) {
      regardingEntityMeta = entityMetadataCollection[i];
      break;
      }
      }
      if (regardingEntityMeta &amp;&amp; regardingEntityMeta.ObjectTypeCode == parentEtc) {
      // Extract parent id from its href
      var parentId = Cinteros.Xrm.SDK.getParameter(href, "id") || Cinteros.Xrm.SDK.getParameter(href, "oId");
      if (parentId) {
      parentId = unescape(parentId);
      var attributeMeta = Cinteros.Xrm.SDK.RetrieveAttribute(regardingEntityMeta.LogicalName, regardingEntityMeta.PrimaryNameAttribute);
      // Retrieve the regarding entity, to be able to find its primary name
      var regardingObject = Cinteros.Xrm.REST.Retrieve(regardingEntityMeta.SchemaName, parentId, "?$select=" + attributeMeta.SchemaName);
      if (regardingObject) {
      // Found regarding record, create lookup object
      var regardingLkp = [{ "id": parentId, "entityType": regardingEntityMeta.LogicalName, "name": regardingObject[attributeMeta.SchemaName]}];
      Xrm.Page.getAttribute("regardingobjectid").setValue(regardingLkp);
      return true;
      }
      }
      }
      }
      return false;
      }
      catch (e) {
      window.alert("Error in verifyRegarding:\n\n" + e.description);
      }
      }
      }
      &lt;/pre&gt;
      &lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; The javascript-functions in namespace&lt;/em&gt; &lt;code&gt;Cinteros.Xrm&lt;/code&gt; &lt;em&gt;are part of our internally developed tools, but the names should be quite self-explanatory.&lt;br&gt;&lt;/em&gt;REST &lt;em&gt;functionality can be replaced by similar functionality in the &lt;strong&gt;CrmRestKit&lt;/strong&gt;, see &lt;/em&gt;&lt;a href="http://crmrestkit.codeplex.com/"&gt;&lt;em&gt;http://crmrestkit.codeplex.com/&lt;/em&gt;&lt;/a&gt;&lt;em&gt;, or by other custom made code.&lt;br&gt;&lt;/em&gt;MetaData &lt;em&gt;functionality can be replaced by functionality in the &lt;strong&gt;MS CRM SDK&lt;/strong&gt;, see &lt;/em&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/gg594428.aspx"&gt;&lt;em&gt;Sample: Retrieve Entity Metadata Using JScript&lt;/em&gt;&lt;/a&gt;&lt;em&gt;.&lt;br&gt;Feel free to &lt;strong&gt;contact me&lt;/strong&gt; if you have any questions.&lt;/em&gt;&lt;/p&gt;
      &lt;p&gt;Function to register for the formLoad event on each activity entity that shall have this functionality:&lt;/p&gt;&lt;pre class="brush: js"&gt;Cinteros.Xrm.Activity = {
      formLoad: function () {
      try {
      // Only do this when creating new activities
      if (Xrm.Page.ui.getFormType() === 1) {
      // For this example - four entities are allowed to be set as regarding
      var allowedEntities = ["contact", "lead", "opportunity", "jr_my_custom_entity"];
      if (this._verifyRegarding(allowedEntities) === false) {
      window.alert("Activity must be created from a valid regarding record.\n(" + allowedEntities.toString() + ")");
      Xrm.Page.ui.close();
      }
      }
      }
      catch (e) {
      window.alert("Error during formLoad:\n\n" + e.description);
      }
      }
      }&lt;/pre&gt;
      &lt;p&gt;It is possible to call the &lt;code&gt;_verifyRegarding&lt;/code&gt; function without any parameter, thus allowing any entity as regarding object. This will however read all entity metadata from the database, which typically takes a few seconds. So specifying the allowed set of regarding entity types is recommended.&lt;/p&gt;
      &lt;p&gt;Exclude the if-clause when calling the &lt;code&gt;_verifyRegarding&lt;/code&gt; function to ignore it's return value. Then the function will simply populate the regarding field when possible, without any verification that the field must be populated, or that it must be populated by a specific entity type.&lt;/p&gt;
      &lt;p&gt;&lt;em&gt;Note that this solution uses window references and url parameters to interpret the caller. This is &lt;strong&gt;probably &lt;/strong&gt;not supported according to MS CRM SDK, but it is not unsupported either, as it does not alter the DOM or use undocumented javascript methods, and it includes quite good error handling.&lt;/em&gt;&lt;/p&gt;
    </content>
    <updated>2012-08-20T08:52:31+02:00</updated>
    <published>2012-08-20T08:45:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;CkUNR3wzfyp7ImA9WhJWEUg.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-08-16T22:51:36.287+02:00</app:edited>
    <app:control app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">
      <app:draft>yes</app:draft>
    </app:control>
    <thr:total>0</thr:total>
    <title type="text">Plugin or workflow - when to use what</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-9152253876405861335</id>
    <link href="http://jonasrapp.cinteros.se/2012/08/pluginorworkflow.html#comment-form" rel="replies" type="text/html" title="0 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/9152253876405861335" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/9152253876405861335" rel="self" type="application/atom+xml" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <content type="html" />
    <updated>2012-08-16T22:51:36+02:00</updated>
    <published>2012-08-16T22:51:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;CkUHSX89fSp7ImA9WhJWEUg.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-08-16T22:50:38.165+02:00</app:edited>
    <app:control app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">
      <app:draft>yes</app:draft>
    </app:control>
    <thr:total>0</thr:total>
    <title type="text">Plugin to aggregate info from N:N to both sides</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-3884622752030669270</id>
    <link href="http://jonasrapp.cinteros.se/2012/08/NN-aggregation.html#comment-form" rel="replies" type="text/html" title="0 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/3884622752030669270" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/3884622752030669270" rel="self" type="application/atom+xml" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <content type="html" />
    <updated>2012-08-16T22:50:38+02:00</updated>
    <published>2012-08-16T22:50:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;DkEGSH04eCp7ImA9WhJXGEg.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-08-13T12:43:49.330+02:00</app:edited>
    <thr:total>0</thr:total>
    <title type="text">Xrm.Utility methods in MS Dynamics CRM UR8</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-4165873211597860725</id>
    <link href="http://jonasrapp.cinteros.se/feeds/4165873211597860725/comments/default" rel="replies" type="application/atom+xml" title="Post Comments" />
    <link href="http://jonasrapp.cinteros.se/2012/08/xrmutility-methods-in-ms-dynamics-crm.html#comment-form" rel="replies" type="text/html" title="0 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/4165873211597860725" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/4165873211597860725" rel="self" type="application/atom+xml" />
    <link href="http://jonasrapp.cinteros.se/2012/08/xrmutility-methods-in-ms-dynamics-crm.html" rel="alternate" type="text/html" title="Xrm.Utility methods in MS Dynamics CRM UR8" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <category term="Javascript" scheme="http://www.blogger.com/atom/ns#" />
    <category term="Rollup 8" scheme="http://www.blogger.com/atom/ns#" />
    <category term="Forms" scheme="http://www.blogger.com/atom/ns#" />
    <category term="WebResources" scheme="http://www.blogger.com/atom/ns#" />
    <content type="html">
      &lt;ul&gt; &lt;li&gt;&lt;em&gt;Have you ever used the unsupported javascript-function &lt;code&gt;&lt;strong&gt;openObj&lt;/strong&gt;&lt;/code&gt; to open a form in Microsoft Dynamics CRM 2011?&lt;/em&gt;  &lt;li&gt;&lt;em&gt;Have you ever cursed out loud over getting correct paths and parameters for &lt;strong&gt;URL Addressable Forms&lt;/strong&gt;?&lt;/em&gt;  &lt;li&gt;&lt;em&gt;Have you ever implemented your own functionality to open a Microsoft Dynamics CRM 2011 &lt;strong&gt;webresource&lt;/strong&gt; in a new window?&lt;/em&gt;&lt;/li&gt;&lt;/ul&gt; &lt;p&gt;&lt;strong&gt;Stop that. Now.&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;At last, in UR8 Microsoft has included supported javascript-functions for those actions, providing a better user experience as well as nicer code than using the functionality of &lt;a href="http://msdn.microsoft.com/en-us/library/gg328483.aspx" target="_blank"&gt;URL Addressable Forms and Views&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;No new SDK version has been released yet, so you cannot read about it or find any examples there, it was just recently announced in &lt;a href="http://blogs.msdn.com/b/crm/archive/2012/07/18/new-xrm-utility-functions-in-update-rollup-8-for-microsoft-dynamics-crm-2011-and-microsoft-dynamics-crm-online.aspx" target="_blank"&gt;&lt;strong&gt;The Microsoft Dynamics CRM Blog&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt; &lt;h2&gt;&lt;strong&gt;Basic description&lt;/strong&gt;&lt;/h2&gt; &lt;p&gt;There is a javascript library called &lt;code&gt;Xrm.Utility&lt;/code&gt; which is available "everywhere" as long as you have a CRM context.&lt;/p&gt;&lt;pre class="brush: js"&gt;Xrm.Utility.openEntityForm(name, id, parameters)
      Xrm.Utility.openWebResource(webResourceName, webResourceData, width, height)

      &lt;/pre&gt;
      &lt;p&gt;Both functions return the window object that is created which allows you to e.g. move and resize the window.&lt;/p&gt;
      &lt;p&gt;The &lt;code&gt;parameters&lt;/code&gt; parameter can be used to set default values when creating a new record and to specify which form to display.&lt;/p&gt;
      &lt;p&gt;One of the best things though – is that the &lt;code&gt;openEntityForm&lt;/code&gt; function takes the &lt;strong&gt;LogicalName&lt;/strong&gt; of the entity instead of forcing us to make a metadata request to get the &lt;strong&gt;ObjectTypeCode&lt;/strong&gt;…!&lt;/p&gt;
      &lt;h2&gt;&lt;strong&gt;Usage examples&lt;/strong&gt;&lt;/h2&gt;
      &lt;a name='more'&gt;&lt;/a&gt;
      &lt;h5&gt;openEntityForm&lt;/h5&gt;
      &lt;ul&gt;
      &lt;li&gt;Open a record from a custom html or Silverlight displaying CRM data
      &lt;li&gt;Open a new record form from a custom ribbon button populating with default data
      &lt;li&gt;Create a new record in javascript and then opening that new record&lt;/li&gt;&lt;/ul&gt;
      &lt;h5&gt;openWebResource&lt;/h5&gt;
      &lt;ul&gt;
      &lt;li&gt;Open a webresource from a custom ribbon button (e.g. html page with Bing map integration)
      &lt;li&gt;Prompt user for confirmation using your own nicely styled Confirm dialog (instead of ugly styled &lt;code&gt;window.confirm(…)&lt;/code&gt;)&lt;/li&gt;&lt;/ul&gt;
      &lt;p&gt;&lt;em&gt;&lt;font size="1"&gt;Thank's &lt;/font&gt;&lt;/em&gt;&lt;a href="http://markuserlandsson.wordpress.com/" target="_blank"&gt;&lt;em&gt;&lt;font size="1"&gt;Markus&lt;/font&gt;&lt;/em&gt;&lt;/a&gt;&lt;em&gt;&lt;font size="1"&gt; for enlightening me about this news!&lt;/font&gt;&lt;/em&gt;&lt;/p&gt;
    </content>
    <updated>2012-08-13T12:43:49+02:00</updated>
    <published>2012-08-09T09:22:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;Ak8NRXw6eCp7ImA9WhJXGEg.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-08-13T13:54:54.210+02:00</app:edited>
    <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://lh4.ggpht.com/-UpE6Fzjy6J0/UACDepONfDI/AAAAAAAAAp0/xQoAveMhT7Q/s72-c/SaveAndPublish32_thumb%25255B1%25255D.png?imgmax=800" height="72" width="72" />
    <thr:total>0</thr:total>
    <title type="text">Save &amp; Publish Button for Forms and WebResources</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-7894974964125106552</id>
    <link href="http://jonasrapp.cinteros.se/feeds/7894974964125106552/comments/default" rel="replies" type="application/atom+xml" title="Post Comments" />
    <link href="http://jonasrapp.cinteros.se/2012/08/save-publish-button-for-forms-and.html#comment-form" rel="replies" type="text/html" title="0 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/7894974964125106552" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/7894974964125106552" rel="self" type="application/atom+xml" />
    <link href="http://jonasrapp.cinteros.se/2012/08/save-publish-button-for-forms-and.html" rel="alternate" type="text/html" title="Save &amp; Publish Button for Forms and WebResources" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <category term="Customization" scheme="http://www.blogger.com/atom/ns#" />
    <category term="Ribbon" scheme="http://www.blogger.com/atom/ns#" />
    <content type="html">
      &lt;p&gt;While working with customizations and UI development in CRM 2011 – have you ever been looking for that "Save and Publish" button? Have you ever &lt;strong&gt;not &lt;/strong&gt;been looking for it?&lt;/p&gt; &lt;p&gt;We all wonder why it is not there and there is a &lt;a href="https://connect.microsoft.com/dynamicssuggestions/feedback/details/678566/save-publish-close-while-customizing" target="_blank"&gt;case on Microsoft Connect&lt;/a&gt; requesting it.&lt;br&gt;But relax, it is quite easy to get it in there right now.&lt;/p&gt; &lt;h2&gt;Annoying facts:&lt;/h2&gt; &lt;p&gt;&lt;a href="http://lh6.ggpht.com/-LH8C6QZjlqg/UACDd7iuvGI/AAAAAAAAApw/VYlZkZCNppU/s1600-h/SaveAndPublish32%25255B3%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: right; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SaveAndPublish32" border="0" alt="SaveAndPublish32" src="http://lh4.ggpht.com/-UpE6Fzjy6J0/UACDepONfDI/AAAAAAAAAp0/xQoAveMhT7Q/SaveAndPublish32_thumb%25255B1%25255D.png?imgmax=800" width="36" height="36"&gt;&lt;/a&gt;It seems to me that someone just forgot to implement this function. There is a button icon &lt;code&gt;/CRMWEB/_imgs/ribbon/SaveAndPublish32.png&lt;/code&gt; (and corresponding 16 pix icon). The javascript function being called when clicking the existing Publish button in form customization is called &lt;code&gt;SaveAndPublish()&lt;/code&gt;. It just does not do what the name indicates.&lt;/p&gt; &lt;h2&gt;Solution:&lt;/h2&gt; &lt;p&gt;To get a Save &amp; Publish button:&lt;/p&gt; &lt;li&gt;Create a javascript webresource that first calls the Save function and then the Publish function  &lt;li&gt;Create the button in the RibbonDiffXml section of customizations.xml, using existing icon files and calling the function created in step 1  &lt;li&gt;Import the ribbon customizations  &lt;p&gt;&lt;a href="http://lh3.ggpht.com/-aZT1I7i7Lpw/UACDfYKRhyI/AAAAAAAAApc/DgE32eynjCI/s1600-h/SnP%25255B2%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SnP" border="0" alt="SnP" src="http://lh3.ggpht.com/-fNPD3apMxOU/UACDgUb5INI/AAAAAAAAApk/UTZm7YhMPNo/SnP_thumb.png?imgmax=800" width="244" height="160"&gt;&lt;/a&gt;&lt;/p&gt; &lt;h5&gt;Javascript:&lt;/h5&gt; &lt;p&gt;&lt;pre class="brush: js"&gt;Cinteros.Xrm.Customization = {
      SaveAndPublishForm: function () {
      try {
      SaveForm(false);
      }
      catch (e) { }
      try {
      SaveAndPublish();
      }
      catch (e) { }
      },
      SaveAndPublishWebResource: function () {
      try {
      SaveForm(false);
      }
      catch (e) { }
      try {
      PublishWebResource();
      }
      catch (e) { }
      }
      }&lt;/pre&gt;
      &lt;h5&gt;RibbonDiffXml:&lt;/h5&gt;
      &lt;p&gt;&lt;pre class="brush: html"&gt;  &lt;RibbonDiffXml&gt;
      &lt;CustomActions&gt;
      &lt;CustomAction Id="Cint.Mscrm.FormEditorTab.SaveButtons.Controls" Location="Mscrm.FormEditorTab.SaveButtons.Controls._children" Sequence="1"&gt;
      &lt;CommandUIDefinition&gt;
      &lt;Button Command="Cint.Mscrm.FormEditorTab.SaveButtons.Controls.Button.SaveAndPublish" CommandType="General" Id="Cint.Mscrm.FormEditorTab.SaveButtons.Controls.Button.SaveAndPublish.Id" Image16by16="/_imgs/ribbon/SaveAndPublish16.png" Image32by32="/_imgs/ribbon/SaveAndPublish32.png" TemplateAlias="o1" LabelText="$LocLabels:Cint.Mscrm.FormEditorTab.SaveAndPublish.LabelText" ToolTipTitle="$LocLabels:Cint.Mscrm.FormEditorTab.SaveAndPublish.ToolTip" ToolTipDescription="$LocLabels:Cint.Mscrm.FormEditorTab.SaveAndPublish.ToolTipDescription" /&gt;
      &lt;/CommandUIDefinition&gt;
      &lt;/CustomAction&gt;
      &lt;CustomAction Id="Cint.Mscrm.WebResourceEditTab.Save.Controls" Location="Mscrm.WebResourceEditTab.Save.Controls._children" Sequence="1"&gt;
      &lt;CommandUIDefinition&gt;
      &lt;Button Command="Cint.Mscrm.WebResourceEditTab.Save.Controls.Button.SaveAndPublish" CommandType="General" Id="Cint.Mscrm.WebResourceEditTab.Save.Controls.Button.SaveAndPublish.Id" Image16by16="/_imgs/ribbon/SaveAndPublish16.png" Image32by32="/_imgs/ribbon/SaveAndPublish32.png" TemplateAlias="o1" LabelText="$LocLabels:Cint.Mscrm.FormEditorTab.SaveAndPublish.LabelText" ToolTipTitle="$LocLabels:Cint.Mscrm.FormEditorTab.SaveAndPublish.ToolTip" ToolTipDescription="$LocLabels:Cint.Mscrm.FormEditorTab.SaveAndPublish.ToolTipDescription" /&gt;
      &lt;/CommandUIDefinition&gt;
      &lt;/CustomAction&gt;
      &lt;/CustomActions&gt;
      &lt;Templates&gt;
      &lt;RibbonTemplates Id="Mscrm.Templates"&gt;&lt;/RibbonTemplates&gt;
      &lt;/Templates&gt;
      &lt;CommandDefinitions&gt;
      &lt;CommandDefinition Id="Cint.Mscrm.FormEditorTab.SaveButtons.Controls.Button.SaveAndPublish"&gt;
      &lt;EnableRules&gt;
      &lt;EnableRule Id="Mscrm.Enable.IsCustomizableManagedPropertyRule" /&gt;
      &lt;/EnableRules&gt;
      &lt;DisplayRules /&gt;
      &lt;Actions&gt;
      &lt;JavaScriptFunction FunctionName="Cinteros.Xrm.Customization.SaveAndPublish" Library="$webresource:cint_/scripts/utils_support.js" /&gt;
      &lt;/Actions&gt;
      &lt;/CommandDefinition&gt;
      &lt;CommandDefinition Id="Cint.Mscrm.WebResourceEditTab.Save.Controls.Button.SaveAndPublish"&gt;
      &lt;EnableRules&gt;
      &lt;EnableRule Id="Mscrm.Enable.IsWebResourceCustomizableRule" /&gt;
      &lt;/EnableRules&gt;
      &lt;DisplayRules /&gt;
      &lt;Actions&gt;
      &lt;JavaScriptFunction FunctionName="Cinteros.Xrm.Customization.SaveAndPublishWebResource" Library="$webresource:cint_/scripts/utils_support.js" /&gt;
      &lt;/Actions&gt;
      &lt;/CommandDefinition&gt;
      &lt;/CommandDefinitions&gt;
      &lt;RuleDefinitions&gt;
      &lt;TabDisplayRules /&gt;
      &lt;DisplayRules /&gt;
      &lt;EnableRules /&gt;
      &lt;/RuleDefinitions&gt;
      &lt;LocLabels&gt;
      &lt;LocLabel Id="Cint.Mscrm.FormEditorTab.SaveAndPublish.LabelText"&gt;
      &lt;Titles&gt;
      &lt;Title languagecode="1033" description="Save and Publish" /&gt;
      &lt;Title languagecode="1053" description="Spara och Publicera" /&gt;
      &lt;/Titles&gt;
      &lt;/LocLabel&gt;
      &lt;LocLabel Id="Cint.Mscrm.FormEditorTab.SaveAndPublish.ToolTip"&gt;
      &lt;Titles&gt;
      &lt;Title languagecode="1033" description="Save and Publish" /&gt;
      &lt;Title languagecode="1053" description="Spara och Publicera" /&gt;
      &lt;/Titles&gt;
      &lt;/LocLabel&gt;
      &lt;LocLabel Id="Cint.Mscrm.FormEditorTab.SaveAndPublish.ToolTipDescription"&gt;
      &lt;Titles&gt;
      &lt;Title languagecode="1033" description="Saves and publishes the form" /&gt;
      &lt;Title languagecode="1053" description="Sparar och publicerar formuläret" /&gt;
      &lt;/Titles&gt;
      &lt;/LocLabel&gt;
      &lt;/LocLabels&gt;
      &lt;/RibbonDiffXml&gt;
      &lt;/pre&gt;
      &lt;h2&gt;Shortcut:&lt;/h2&gt;
      &lt;p&gt;If you don't want to do this manually, you can &lt;strong&gt;download&lt;/strong&gt; a solution with just this content &lt;a href="http://sdrv.ms/PI9h7N" target="_blank"&gt;HERE&lt;/a&gt;.&lt;/p&gt;
      &lt;/li&gt;
    </content>
    <updated>2012-08-13T13:54:54+02:00</updated>
    <published>2012-08-08T08:51:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;DkAGQ305fSp7ImA9WhJXGEg.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-08-13T12:45:22.325+02:00</app:edited>
    <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://lh4.ggpht.com/-tVG7uvmE4ks/T_qUfWKkPkI/AAAAAAAAAk0/0WeVObjiLeA/s72-c/VATincorrect_thumb%25255B18%25255D.png?imgmax=800" height="72" width="72" />
    <thr:total>0</thr:total>
    <title type="text">Execute Server-Side Code from Javascript</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-3477207321038306239</id>
    <link href="http://jonasrapp.cinteros.se/feeds/3477207321038306239/comments/default" rel="replies" type="application/atom+xml" title="Post Comments" />
    <link href="http://jonasrapp.cinteros.se/2012/07/execute-server-side-code-from-javascript.html#comment-form" rel="replies" type="text/html" title="0 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/3477207321038306239" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/3477207321038306239" rel="self" type="application/atom+xml" />
    <link href="http://jonasrapp.cinteros.se/2012/07/execute-server-side-code-from-javascript.html" rel="alternate" type="text/html" title="Execute Server-Side Code from Javascript" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <category term="Javascript" scheme="http://www.blogger.com/atom/ns#" />
    <category term="Plugins" scheme="http://www.blogger.com/atom/ns#" />
    <content type="html">
      &lt;h2&gt;Background:&lt;/h2&gt; &lt;p&gt;General business rules shall be implemented in server-side code to ensure its execution regardless of the origin of data changes; CRM UI, workflow, integration or any other application consuming the CRM web services.&lt;/p&gt; &lt;p&gt;But on some occasions it would be handy to be able to execute this code from JavaScript to improve the user's experience of the application.&lt;/p&gt; &lt;h2&gt;Scenario:&lt;/h2&gt; &lt;p&gt;When creating or updating an Account, there is a plugin registered Pre Validation Create/Update to verify that the given VAT number is in a correct format. If not, the plugin throws an exception instructing the user to enter a correct VAT number.&lt;/p&gt; &lt;div&gt;&lt;a href="http://lh4.ggpht.com/-RmJrJhVqaV0/T_qUeayEQ-I/AAAAAAAAAks/TMbH71_yoaE/s1600-h/VATincorrect%25255B20%25255D.png" target="_blank"&gt;&lt;img style="border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="VATincorrect" border="0" alt="VATincorrect" src="http://lh4.ggpht.com/-tVG7uvmE4ks/T_qUfWKkPkI/AAAAAAAAAk0/0WeVObjiLeA/VATincorrect_thumb%25255B18%25255D.png?imgmax=800" width="244" height="154"&gt;&lt;/a&gt;&lt;/div&gt; &lt;p&gt;Another plugin is registered Pre Operation Create/Update to look up city/state/county from given zip-code to ensure correct data for the account. This function consumes an external service from a third party accessible as a web service.&lt;/p&gt; &lt;div&gt;&lt;a href="http://lh3.ggpht.com/-yhP5pOaso2A/T_qUgDnoa1I/AAAAAAAAAk4/8O24Z5Hsf7M/s1600-h/Account%252520Cinteros%252520zip%25255B2%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="Account Cinteros zip" border="0" alt="Account Cinteros zip" src="http://lh3.ggpht.com/-eVPi4JEsQw4/T_qUhB5wJtI/AAAAAAAAAlE/EoawAf0qYcY/Account%252520Cinteros%252520zip_thumb.png?imgmax=800" width="244" height="98"&gt;&lt;/a&gt;&lt;/div&gt; &lt;h2&gt;Challenge&lt;/h2&gt; &lt;p&gt;To improve user experience, the customer requires &lt;strong&gt;immediate&lt;/strong&gt; verification of the VAT no and lookup of geographic information for the zip-code.&lt;/p&gt;  &lt;a name='more'&gt;&lt;/a&gt; &lt;h2&gt;Solution 1 (bad):&lt;/h2&gt; &lt;p&gt;Required functionality can of course be implemented entirely in JavaScript. Rules for VAT numbers and calls to external web services can be coded in client side code. Calling external services may be a problem, depending on firewall configuration, local browser settings etc. but usually it is possible to find a way around these problems.&lt;/p&gt; &lt;p&gt;Composing and parsing SOAP-messages in javascript is neither intuitive nor fun, but of course it can be done.&lt;/p&gt; &lt;p&gt;This solution however would duplicate the same code in two entirely different environments and languages. Duplicated code is, and I think everyone agrees to this, &lt;strong&gt;NOT&lt;/strong&gt; something we want. Right?!&lt;/p&gt; &lt;p&gt;Especially not from a maintenance perspective.&lt;/p&gt; &lt;h2&gt;Solution 2 (good:)&lt;/h2&gt; &lt;p&gt;Create a &lt;strong&gt;custom entity&lt;/strong&gt; &lt;code&gt;jr_serverfunction&lt;/code&gt; with one text field &lt;code&gt;jr_parameter&lt;/code&gt; and one text field &lt;code&gt;jr_result&lt;/code&gt;.&lt;/p&gt; &lt;div&gt;&lt;a href="http://lh6.ggpht.com/-p4n-Z5OoYZI/T_qhb5SoLNI/AAAAAAAAAlQ/tsx2wYJDWDM/s1600-h/ServerFunction%252520blank%25255B2%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="ServerFunction blank" border="0" alt="ServerFunction blank" src="http://lh3.ggpht.com/-UVITjXx2FQ4/T_qhcwgNJFI/AAAAAAAAAlY/RFo_QNMBaaU/ServerFunction%252520blank_thumb.png?imgmax=800" width="244" height="148"&gt;&lt;/a&gt;&lt;/div&gt; &lt;h3&gt;Server-side&lt;/h3&gt; &lt;ul&gt; &lt;li&gt;Extract logic from the two plugins mentioned to methods in an &lt;strong&gt;isolated C# class&lt;/strong&gt;  &lt;li&gt;Rewrite the plugins to consume this class (to preserve existing functionality invoked on create/update)  &lt;li&gt;Create a plugin triggering &lt;strong&gt;Post Operation RetrieveMultiple&lt;/strong&gt; on &lt;code&gt;jr_serverfunction&lt;/code&gt;. This plugin shall investigate the incoming query to extract it's condition for field &lt;code&gt;jr_parameter&lt;/code&gt; and use this condition to execute desired server-side code  &lt;li&gt;When the result of the function is determined, an instance of entity &lt;code&gt;jr_serverfunction&lt;/code&gt; is created (in code, not saved to the database), resulting data/information placed in field &lt;code&gt;jr_result&lt;/code&gt;, and the entity placed in the &lt;code&gt;EntityCollection&lt;/code&gt; that is to be returned in the query response &lt;/li&gt;&lt;/ul&gt; &lt;p&gt;&lt;a href="http://lh5.ggpht.com/-XqUVEPgPjVU/T_tLz3Z--RI/AAAAAAAAAmw/4g2l8pGjr08/s1600-h/ServerFunction%252520registration%25255B2%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="ServerFunction registration" border="0" alt="ServerFunction registration" src="http://lh3.ggpht.com/-z-LONuhklWA/T_tL07tUk-I/AAAAAAAAAm4/AthBrrbU4AE/ServerFunction%252520registration_thumb.png?imgmax=800" width="244" height="202"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Note that the custom entity will actually &lt;strong&gt;never hold any records&lt;/strong&gt; in the CRM database. This is why I also trigger the Create message and immediately throw an error.&lt;/p&gt; &lt;p&gt;&lt;a href="http://lh4.ggpht.com/-TyzIApdtQIU/T_tL1h-SL6I/AAAAAAAAAnQ/eZdmON4KLtk/s1600-h/ServerFunction%252520assembly%25255B3%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="ServerFunction assembly" border="0" alt="ServerFunction assembly" src="http://lh4.ggpht.com/-yrBoR6ESqno/T_tL2Fp077I/AAAAAAAAAnU/Jlx69RfRpjQ/ServerFunction%252520assembly_thumb%25255B1%25255D.png?imgmax=800" width="644" height="92"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Plugin code:&lt;/p&gt;&lt;pre class="brush: csharp"&gt;public class ServerSideExecution : IPlugin
      {
      public void Execute(IServiceProvider serviceProvider)
      {
      IPluginExecutionContext context = (IPluginExecutionContext)serviceProvider.GetService(typeof(IPluginExecutionContext));
      if (context.MessageName == "Create")
      throw new InvalidPluginExecutionException("Server Function entity cannot be instantiated");

      if (context.MessageName == "RetrieveMultiple" &amp;&amp;
      context.Stage == 40 &amp;&amp;      // Post Operation
      context.PrimaryEntityName == "jr_serverfunction" &amp;&amp;
      context.InputParameters.Contains("Query") &amp;&amp;
      context.InputParameters["Query"] is QueryExpression)
      {
      ITracingService tracer = (ITracingService)serviceProvider.GetService(typeof(ITracingService));
      tracer.Trace("Initialize service etc");
      IOrganizationServiceFactory serviceFactory = (IOrganizationServiceFactory)serviceProvider.GetService(typeof(IOrganizationServiceFactory));
      IOrganizationService service = serviceFactory.CreateOrganizationService(context.UserId);
      QueryExpression query = (QueryExpression)context.InputParameters["Query"];
      tracer.Trace("Extract condition from query");
      ConditionExpression parameterCondition = MyFunctions.GetFilterConditionByAttribute(query.Criteria, "jr_parameter");
      if (parameterCondition != null &amp;&amp; parameterCondition.Values.Count == 1)
      {
      string parameter = parameterCondition.Values[0].ToString().Trim('%');
      tracer.Trace("Parameter is: {0}", parameter);
      string command = parameter.Split(';')[0];
      string result = null;
      switch (command)
      {
      case "VerifyVAT":
      tracer.Trace("Check if VAT number is correct");
      string vat = parameter.Split(';')[1];
      if (MyFunctions.VerifyVAT(vat))
      result = "ok";
      else
      result = "not ok";
      break;
      case "LookupZIP":
      tracer.Trace("Lookup city etc from ZIP code");
      string zip = parameter.Split(';')[1];
      // Returns a semi-colon separated string with city;state;country
      result = MyFunctions.GetZipInfo(zip);
      break;
      // **************************************
      // ** Add more functions here as needed
      // **************************************
      }
      if (result != null)
      {
      tracer.Trace("Create resulting serverfunction entity with result: {0}", result);
      Entity serverfunction = new Entity("jr_serverfunction");
      Guid id = new Guid();
      serverfunction.Id = id;
      serverfunction.Attributes.Add("jr_serverfunctionid", id);
      serverfunction.Attributes.Add("jr_parameter", parameter);
      serverfunction.Attributes.Add("jr_result", result);
      tracer.Trace("Replace contents of resulting entitycollection");
      EntityCollection resultCollection = (EntityCollection)context.OutputParameters["BusinessEntityCollection"];
      resultCollection.Entities.Clear();
      resultCollection.Entities.Add(serverfunction);
      context.OutputParameters["BusinessEntityCollection"] = resultCollection;
      }
      }
      }
      }
      }&lt;/pre&gt;
      &lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; The function &lt;code&gt;MyFunctions.GetFilterConditionByAttribute&lt;/code&gt; is part of internally developed tools. Please contact me if you are interested in how we find specific conditions in a query.&lt;/em&gt; &lt;/p&gt;
      &lt;p&gt;The plugin can easily be tested by making an Advanced Find query on the Server Function entity in the CRM.&lt;/p&gt;
      &lt;p&gt;&lt;a href="http://lh4.ggpht.com/-tO6D-A46v-E/T_tQmCQwuqI/AAAAAAAAAos/FP8BAZ0I5JM/s1600-h/TestVAT%25255B3%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="TestVAT" border="0" alt="TestVAT" src="http://lh5.ggpht.com/-cl3oLOn003s/T_tQm28agXI/AAAAAAAAAow/YXAjbH_kh-w/TestVAT_thumb%25255B1%25255D.png?imgmax=800" width="644" height="202"&gt;&lt;/a&gt; &lt;a href="http://lh5.ggpht.com/-d7d7P6Xc0AU/T_tQnly72FI/AAAAAAAAAo4/qlUQjM1cFiM/s1600-h/TestZIP%25255B3%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="TestZIP" border="0" alt="TestZIP" src="http://lh5.ggpht.com/-hx4bG1wf9BA/T_tQoibbFDI/AAAAAAAAApE/e0vpal-xBzo/TestZIP_thumb%25255B1%25255D.png?imgmax=800" width="644" height="202"&gt;&lt;/a&gt; &lt;/p&gt;
      &lt;h3&gt;Client-side&lt;/h3&gt;
      &lt;p&gt;In the client-side JavaScript a method is registered for the &lt;code&gt;onChange&lt;/code&gt; event of the VAT no field. The function will use the REST endpoint to query CRM for records of &lt;code&gt;jr_serverfunction&lt;/code&gt; where &lt;code&gt;jr_parameter&lt;/code&gt; equals "VerifyVAT;1234567890" (where the numbers should be the number entered on the form). &lt;/p&gt;
      &lt;p&gt;The result will contain one record, and the &lt;code&gt;jr_result&lt;/code&gt; field will contain "ok" or "not ok", which the JavaScript can use to immediately instruct the user to correct the number. &lt;/p&gt;&lt;pre class="brush: js"&gt;Cinteros.Xrm.AccountServerFunction = {
      jr_vat_onChange: function () {
      try {
      var vatNo = Xrm.Page.getAttribute("jr_vat").getValue();
      if (vatNo != null) {
      var parameter = "VerifyVAT;" + vatNo;
      var result = this.ExecuteServerFunction(parameter);
      if (result === "not ok") {
      window.alert("VAT number is not in a correct format");
      }
      }
      }
      catch (e) {
      alert("Error in jr_vat_onChange:\n\n" + e.description);
      }
      },

      ExecuteServerFunction: function (parameter) {
      var result = null;
      var serverFunctionResult = Cinteros.Xrm.REST.RetrieveMultiple("jr_serverfunction",
      "?$select=jr_result" +
      "&amp;$filter=jr_parameter eq '" + parameter + "'");

      if (serverFunctionResult &amp;&amp; serverFunctionResult.length === 1) {
      result = serverFunctionResult[0].jr_result;
      }
      return result;
      }
      }&lt;/pre&gt;
      &lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; The javascript-function &lt;code&gt;Cinteros.Xrm.REST.RetrieveMultiple&lt;/code&gt; is part of our internally developed tools, it may well be replaced by similar functionality in the &lt;strong&gt;CrmRestKit&lt;/strong&gt; (&lt;a href="http://crmrestkit.codeplex.com/"&gt;http://crmrestkit.codeplex.com/&lt;/a&gt;) or by other custom made code.&lt;/em&gt; &lt;/p&gt;
      &lt;p&gt;Registering this function as the onchange event of the &lt;em&gt;VAT number&lt;/em&gt; field immediately executes the server-side functionality for validating a VAT number when the user changes the field in the CRM client. &lt;/p&gt;
      &lt;div&gt;&lt;a href="http://lh6.ggpht.com/-i_LMx9FbJsE/T_tKjDXSHbI/AAAAAAAAAnY/xvdjxARxYA0/s1600-h/VATeventhandler%25255B1%25255D.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="VATeventhandler" border="0" alt="VATeventhandler" src="http://lh5.ggpht.com/-6Yyr9Z_LWxw/T_tKj4WuITI/AAAAAAAAAnc/WG1sfnd-ebA/VATeventhandler_thumb%25255B1%25255D.png?imgmax=800" width="644" height="166"&gt;&lt;/a&gt; &lt;a href="http://lh4.ggpht.com/-00w-21t3moo/T_tKkTIjuoI/AAAAAAAAAmg/i9MygB0ov_c/s1600-h/VATincorrectJS2.png" target="_blank"&gt;&lt;img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="VATincorrectJS" border="0" alt="VATincorrectJS" src="http://lh4.ggpht.com/-Hz1IqPZPqgs/T_tKlC-E1wI/AAAAAAAAAmk/DT6TJW9CBaI/VATincorrectJS_thumb.png?imgmax=800" width="244" height="172"&gt;&lt;/a&gt; &lt;/div&gt;
      &lt;p&gt;Corresponding &lt;code&gt;onChange&lt;/code&gt; event for the zip-code field can be implemented to get geographic information and automatically populate city/state etc. on the form. &lt;/p&gt;&lt;pre class="brush: js"&gt;address1_postalcode_onChange: function () {
      try {
      var zipCode = Xrm.Page.getAttribute("address1_postalcode").getValue();
      if (zipCode != null) {
      var parameter = "LookupZIP;" + zipCode;
      var result = this.ExecuteServerFunction(parameter);
      if (result) {
      var city = result.split(';')[0];
      var state = result.split(';')[1];
      var country = result.split(';')[2];
      Xrm.Page.getAttribute("address1_city").setValue(city);
      Xrm.Page.getAttribute("address1_stateorprovince").setValue(state);
      Xrm.Page.getAttribute("address1_country").setValue(country);
      }
      }
      }
      catch (e) {
      alert("Error in address1_postalcode_onChange:\n\n" + e.description);
      }
      }
      &lt;/pre&gt;
    </content>
    <updated>2012-08-13T12:45:22+02:00</updated>
    <published>2012-07-25T09:19:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;D04GQXk7cSp7ImA9WhJXGEg.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-08-13T13:05:20.709+02:00</app:edited>
    <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://2.bp.blogspot.com/-fdAordYpK6E/T-r1yPdGB9I/AAAAAAAAAkI/uIQ3oOVr9DQ/s72-c/duplicate.png" height="72" width="72" />
    <thr:total>0</thr:total>
    <title type="text">Adding Duplicates in N:N-Relations</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-1897077908610568276</id>
    <link href="http://jonasrapp.cinteros.se/feeds/1897077908610568276/comments/default" rel="replies" type="application/atom+xml" title="Post Comments" />
    <link href="http://jonasrapp.cinteros.se/2012/07/adding-duplicates-in-nn-relations.html#comment-form" rel="replies" type="text/html" title="0 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/1897077908610568276" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/1897077908610568276" rel="self" type="application/atom+xml" />
    <link href="http://jonasrapp.cinteros.se/2012/07/adding-duplicates-in-nn-relations.html" rel="alternate" type="text/html" title="Adding Duplicates in N:N-Relations" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <category term="Plugins" scheme="http://www.blogger.com/atom/ns#" />
    <category term="N:N-relations" scheme="http://www.blogger.com/atom/ns#" />
    <content type="html">
      The possibility to use many-to-many relations in Microsoft Dynamics CRM 2011 is very handy for various scenarios.&lt;br&gt; &lt;div&gt;However, it's implementation is not very forgiving when you try to add a relation which already exists.&lt;/div&gt; &lt;div style="text-align: center; clear: both" class="separator"&gt;&lt;a style="margin-left: 1em; margin-right: 1em" href="http://2.bp.blogspot.com/-fdAordYpK6E/T-r1yPdGB9I/AAAAAAAAAkI/uIQ3oOVr9DQ/s1600/duplicate.png" imageanchor="1"&gt;&lt;img border="0" src="http://2.bp.blogspot.com/-fdAordYpK6E/T-r1yPdGB9I/AAAAAAAAAkI/uIQ3oOVr9DQ/s320/duplicate.png" width="320" height="181"&gt;&lt;/a&gt;&lt;/div&gt; &lt;div&gt; &lt;/div&gt; &lt;div&gt;There is no way to configure the relationship or functionality of the "Add existing..." ribbon button to prevent this "ugly" message - so I decided to create a plugin which smooths things out, so that adding a relation which already exists only makes sure the relationship is there, but does not complain if it already was.&lt;/div&gt; &lt;div&gt; &lt;/div&gt; &lt;div&gt;&lt;b&gt;Scenario&lt;/b&gt;&lt;/div&gt; &lt;div&gt;We have a N:N-relation between Account and Product, to indicate which products are interesting to which accounts.&lt;/div&gt; &lt;div style="text-align: center; clear: both" class="separator"&gt;&lt;a style="margin-left: 1em; margin-right: 1em" href="http://3.bp.blogspot.com/-2gw4hPYmxrI/T-r3RuvtX8I/AAAAAAAAAkQ/JXT1U6xdL4Y/s1600/NN-association.png" imageanchor="1"&gt;&lt;img border="0" src="http://3.bp.blogspot.com/-2gw4hPYmxrI/T-r3RuvtX8I/AAAAAAAAAkQ/JXT1U6xdL4Y/s320/NN-association.png" width="320" height="200"&gt;&lt;/a&gt;&lt;/div&gt; &lt;div&gt; &lt;/div&gt; &lt;div&gt;Clicking the Add Existing Product button brings up the lookup dialog for products.&lt;/div&gt; &lt;div&gt;When I now want to add a number of products, I do not want to have recall or check which products were already added. I just want to select all products (we can really sell anything to this company ;) click OK and be done with it.&lt;/div&gt; &lt;div style="text-align: center; clear: both" class="separator"&gt;&lt;a style="margin-left: 1em; margin-right: 1em" href="http://3.bp.blogspot.com/-2EXS2dUfnXs/T-r5_MTO9BI/AAAAAAAAAkc/mkCdE0wtVYg/s1600/NN-addexisting.png" imageanchor="1"&gt;&lt;img border="0" src="http://3.bp.blogspot.com/-2EXS2dUfnXs/T-r5_MTO9BI/AAAAAAAAAkc/mkCdE0wtVYg/s320/NN-addexisting.png" width="320" height="232"&gt;&lt;/a&gt;&lt;/div&gt; &lt;div&gt; &lt;/div&gt; &lt;div&gt;&lt;b&gt;Solution&lt;/b&gt;&lt;/div&gt; &lt;div&gt;We can create a plugin before main operation that verifies if the added relation already exists. But if it exists, we cannot prevent the relation from being created in any other way than throwing an exception, which will then result in a similar "ugly" message to the user, except it will contain the text we throw.&lt;/div&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;div&gt;So we have to get around the implementation in the main operation (CRM core) some other way.&lt;/div&gt; &lt;div&gt;My choice was to simply delete the existing relation, so adding the new one will not be a problem.&lt;/div&gt; &lt;div&gt;Naturally, this causes extra transactions, but in normal circumstances this will not have any greater impact.&lt;/div&gt; &lt;div&gt; &lt;/div&gt; &lt;div&gt; &lt;/div&gt;&lt;pre class="brush: csharp"&gt;using System;
      using System.ServiceModel;
      using Microsoft.Xrm.Sdk;
      using Microsoft.Xrm.Sdk.Messages;
      using Microsoft.Xrm.Sdk.Metadata;
      using Microsoft.Xrm.Sdk.Query;

      namespace Cinteros.Xrm
      {
      public class AssociateAllower : IPlugin
      {
      public void Execute(IServiceProvider serviceProvider)
      {
      IPluginExecutionContext context = (IPluginExecutionContext)serviceProvider.GetService(typeof(IPluginExecutionContext));

      if (context.MessageName == "Associate" &amp;&amp;
      context.Stage == 20 &amp;&amp;      // Before, inside transaction
      context.Mode == 0 &amp;&amp;        // Synchronous
      context.InputParameters.Contains("Target") &amp;&amp;
      context.InputParameters["Target"] is EntityReference &amp;&amp;
      context.InputParameters.Contains("Relationship") &amp;&amp;
      context.InputParameters["Relationship"] is Relationship &amp;&amp;
      context.InputParameters.Contains("RelatedEntities") &amp;&amp;
      context.InputParameters["RelatedEntities"] is EntityReferenceCollection)
      {
      try
      {
      ITracingService tracer = (ITracingService)serviceProvider.GetService(typeof(ITracingService));
      IOrganizationServiceFactory serviceFactory = (IOrganizationServiceFactory)serviceProvider.GetService(typeof(IOrganizationServiceFactory));
      IOrganizationService service = serviceFactory.CreateOrganizationService(context.UserId);

      Trace(tracer, "Get the name of the intersect table and related entities from the context");
      Relationship relationship = ((Relationship)context.InputParameters["Relationship"]);
      Trace(tracer, "Intersect: {0}", relationship);
      EntityReference entity1ref = (EntityReference)context.InputParameters["Target"];
      Trace(tracer, "Entity1: {0} {1}", entity1ref.LogicalName, entity1ref.Id);
      EntityReferenceCollection entity2refs = (EntityReferenceCollection)context.InputParameters["RelatedEntities"];
      Trace(tracer, "Entity2 count: {0}", entity2refs.Count);

      Trace(tracer, "Get metadata for intersect relation: {0}", relationship);
      RetrieveRelationshipResponse relationshipmetadata = (RetrieveRelationshipResponse)service.Execute(new RetrieveRelationshipRequest() { Name = relationship.SchemaName });
      if (relationshipmetadata != null &amp;&amp; relationshipmetadata.RelationshipMetadata is ManyToManyRelationshipMetadata)
      {
      ManyToManyRelationshipMetadata mmrel = (ManyToManyRelationshipMetadata)relationshipmetadata.RelationshipMetadata;
      Trace(tracer, "Get intersect attribute names (we cannot know which entity is entity1 and which is entity2)");
      string entity1idattribute = mmrel.Entity1LogicalName == entity1ref.LogicalName ? mmrel.Entity1IntersectAttribute : mmrel.Entity2IntersectAttribute;
      string entity2idattribute = mmrel.Entity1LogicalName == entity1ref.LogicalName ? mmrel.Entity2IntersectAttribute : mmrel.Entity1IntersectAttribute;
      Trace(tracer, "Entiy1id: {0} Entity2id: {1}", entity1idattribute, entity2idattribute);

      Trace(tracer, "Verify if any of the new relations already exist");
      foreach (EntityReference entity2ref in entity2refs)
      {
      QueryByAttribute qba = new QueryByAttribute(relationship.SchemaName);
      qba.AddAttributeValue(entity1idattribute, entity1ref.Id);
      qba.AddAttributeValue(entity2idattribute, entity2ref.Id);
      EntityCollection existingAssociations = service.RetrieveMultiple(qba);
      Trace(tracer, "Found {0} existing relations", existingAssociations.Entities.Count);
      if (existingAssociations.Entities.Count &gt; 0)
      {
      EntityReferenceCollection deleteRefs = new EntityReferenceCollection();
      deleteRefs.Add(entity2ref);
      Trace(tracer, "Disassociating entities");
      service.Execute(new DisassociateRequest()
      {
      Target = entity1ref,
      RelatedEntities = deleteRefs,
      Relationship = relationship
      });
      Trace(tracer, "Disassociated");
      }
      }
      }
      else
      {
      throw new InvalidPluginExecutionException("Metadata for relation " + relationship + " is not of type ManyToManyRelationshipMetadata");
      }
      Trace(tracer, "Done!");
      }
      catch (FaultException&lt;OrganizationServiceFault&gt; ex)
      {
      throw new InvalidPluginExecutionException(
      String.Format("An error occurred in plug-in {0}. {1}: {2}", this, ex, ex.Detail.Message));
      }
      }
      }

      private void Trace(ITracingService tracer, string format, params object[] args)
      {
      tracer.Trace(DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss.fff") + " " + format, args);
      }
      }
      }

      &lt;/pre&gt;
    </content>
    <updated>2012-08-13T13:05:20+02:00</updated>
    <published>2012-07-11T07:39:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;CUIDQ30-eyp7ImA9WhJSE0Q.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-07-04T11:19:32.353+02:00</app:edited>
    <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://2.bp.blogspot.com/-YiFS6ZxZ2jo/T-qrTH8w4uI/AAAAAAAAAj8/VAnf0i0ilpw/s72-c/aladdin-choklad_24413390_170792762.jpg" height="72" width="72" />
    <thr:total>4</thr:total>
    <title type="text">The Welcome Post</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-5362943094520094193</id>
    <link href="http://jonasrapp.cinteros.se/feeds/5362943094520094193/comments/default" rel="replies" type="application/atom+xml" title="Post Comments" />
    <link href="http://jonasrapp.cinteros.se/2012/07/the-welcome-post.html#comment-form" rel="replies" type="text/html" title="4 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/5362943094520094193" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/5362943094520094193" rel="self" type="application/atom+xml" />
    <link href="http://jonasrapp.cinteros.se/2012/07/the-welcome-post.html" rel="alternate" type="text/html" title="The Welcome Post" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <content type="html">
      &lt;div class="separator" style="clear: both; text-align: center;"&gt;
      &lt;a href="http://2.bp.blogspot.com/-YiFS6ZxZ2jo/T-qrTH8w4uI/AAAAAAAAAj8/VAnf0i0ilpw/s1600/aladdin-choklad_24413390_170792762.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"&gt;&lt;img border="0" src="http://2.bp.blogspot.com/-YiFS6ZxZ2jo/T-qrTH8w4uI/AAAAAAAAAj8/VAnf0i0ilpw/s1600/aladdin-choklad_24413390_170792762.jpg" /&gt;&lt;/a&gt;&lt;/div&gt;
      There must be a Welcome Post.&lt;br /&gt;
      So this is it.&lt;br /&gt;
      &lt;br /&gt;
      &lt;b&gt;Welcome to my blog about development on the Microsoft Dynamics CRM platform!&lt;/b&gt;&lt;br /&gt;
      &lt;br /&gt;
      The blog will focus on plugin development in C# and UI development in javascript, but in the words of mama Gump - &lt;i&gt;Ya never know what'ya gonna get&lt;/i&gt;.
    </content>
    <updated>2012-07-04T11:19:32+02:00</updated>
    <published>2012-07-04T10:23:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;DkQFQncyeSp7ImA9WhJREEk.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-07-12T00:05:13.991+02:00</app:edited>
    <app:control app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">
      <app:draft>yes</app:draft>
    </app:control>
    <thr:total>0</thr:total>
    <title type="text">Create E-mail to any entity</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-1130641513967870221</id>
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/1130641513967870221" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/1130641513967870221" rel="self" type="application/atom+xml" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <category term="Javascript" scheme="http://www.blogger.com/atom/ns#" />
    <category term="Ribbons" scheme="http://www.blogger.com/atom/ns#" />
    <content type="html" />
    <updated>2012-07-12T00:05:13+02:00</updated>
    <published>2012-06-29T13:39:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;CkQNRnc5eSp7ImA9WhJWEUg.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-08-16T22:53:17.921+02:00</app:edited>
    <app:control app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">
      <app:draft>yes</app:draft>
    </app:control>
    <thr:total>0</thr:total>
    <title type="text">Plugin to correct time zone problems</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-6942246382806269927</id>
    <link href="http://jonasrapp.cinteros.se/2012/06/timezonefix.html#comment-form" rel="replies" type="text/html" title="0 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/6942246382806269927" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/6942246382806269927" rel="self" type="application/atom+xml" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <content type="html">
      &lt;b&gt;Problem:&lt;/b&gt; DateOnly fields are stored as true DateTime fields. When working over different time zones a date stored in one time zone can be shown as the date before in another time zone.&lt;br /&gt;
      blablabla&lt;br /&gt;
      blabla&lt;br /&gt;
      &lt;a name='more'&gt;&lt;/a&gt;
    </content>
    <updated>2012-08-16T22:53:17+02:00</updated>
    <published>2012-06-29T12:03:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;DkUMQHc8fCp7ImA9WhJREEk.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-07-12T00:04:41.974+02:00</app:edited>
    <app:control app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">
      <app:draft>yes</app:draft>
    </app:control>
    <thr:total>0</thr:total>
    <title type="text">Associate/Disassociate sample</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-7059515903079635174</id>
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/7059515903079635174" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/7059515903079635174" rel="self" type="application/atom+xml" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <category term="Plugins" scheme="http://www.blogger.com/atom/ns#" />
    <content type="html" />
    <updated>2012-07-12T00:04:41+02:00</updated>
    <published>2012-06-27T14:38:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;DkUMQHc8fSp7ImA9WhJREEk.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-07-12T00:04:41.975+02:00</app:edited>
    <app:control app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">
      <app:draft>yes</app:draft>
    </app:control>
    <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://4.bp.blogspot.com/-CHWDjnNgzoA/T-djuvtF0uI/AAAAAAAAAi4/X2kXviYgTHg/s72-c/aggr2.jpg" height="72" width="72" />
    <thr:total>0</thr:total>
    <title type="text">Table locked during delete</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-8390645028804813219</id>
    <link href="http://jonasrapp.cinteros.se/2012/06/table-locked-during-delete.html#comment-form" rel="replies" type="text/html" title="0 Comments" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/8390645028804813219" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/8390645028804813219" rel="self" type="application/atom+xml" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <category term="Plugins" scheme="http://www.blogger.com/atom/ns#" />
    <content type="html">
      &lt;b&gt;Summary:&lt;/b&gt; During the deletion of a record, no other records of that entity can be retrieved.&lt;br /&gt;
      &lt;br /&gt;
      For a number of customers we use a generic function developed to aggregate information from children to parent records. This can be used e.g. to keep track of total estimated value for opportunities on a customer or the number of open cases regarding a specific product.&lt;br /&gt;
      The function is implemented as a plugin triggering on specified messages and is configured with a custom entity as shown below.&lt;br /&gt;
      &lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;
      &lt;tr&gt;&lt;td style="text-align: center;"&gt;&lt;a href="http://4.bp.blogspot.com/-CHWDjnNgzoA/T-djuvtF0uI/AAAAAAAAAi4/X2kXviYgTHg/s1600/aggr2.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"&gt;&lt;img border="0" height="400" src="http://4.bp.blogspot.com/-CHWDjnNgzoA/T-djuvtF0uI/AAAAAAAAAi4/X2kXviYgTHg/s400/aggr2.jpg" width="391" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;Aggregation rule to sum opportunity value to potential customer.&lt;/td&gt;&lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;
      The plugin retrieves all "siblings" to the record being updated, and aggregates the value from those to the parent.&lt;br /&gt;
      When the plugin triggers Post Delete no siblings are returned to the plugin, and the sum/count/etc aggregated value will then always be 0.&lt;br /&gt;
      etc etc etc...
    </content>
    <updated>2012-07-12T00:04:41+02:00</updated>
    <published>2012-06-27T09:14:00+02:00</published>
  </entry>
  <entry gd:etag="W/&quot;DUUASXo6eSp7ImA9WhJTFU4.&quot;">
    <app:edited app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">2012-06-24T13:27:28.411+02:00</app:edited>
    <app:control app="http://www.w3.org/2007/app" xmlns:app="http://www.w3.org/2007/app">
      <app:draft>yes</app:draft>
    </app:control>
    <thr:total>0</thr:total>
    <title type="text">Filtering override in plugin</title>
    <id>tag:blogger.com,1999:blog-3534158126191039150.post-5688307323873828305</id>
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/5688307323873828305" rel="edit" type="application/atom+xml" />
    <link href="https://www.blogger.com/feeds/3534158126191039150/posts/default/5688307323873828305" rel="self" type="application/atom+xml" />
    <author>
      <gd:image rel="http://schemas.google.com/g/2005#thumbnail" width="32" height="32" src="//lh6.googleusercontent.com/-R_XLzSOOvqs/AAAAAAAAAAI/AAAAAAAAAsk/wfsnAqqNsCw/s512-c/photo.jpg" />
      <name>Jonas Rapp</name>
      <email>noreply@blogger.com</email>
      <uri>https://plus.google.com/109176631335910576528</uri>
    </author>
    <content type="html">&lt;div&gt;Custom forced filter.&lt;/div&gt;&lt;div&gt;Does not work for charts and reports.&lt;/div&gt;&lt;div&gt;See Connect item #.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div style="font-size:100%"&gt;Mvh&lt;br&gt;Jonas Rapp&lt;br&gt;http://cinteros.se&lt;/div&gt;&lt;/div&gt; </content>
    <updated>2012-06-24T13:27:28+02:00</updated>
    <published>2012-06-24T13:27:00+02:00</published>
  </entry>
</feed>